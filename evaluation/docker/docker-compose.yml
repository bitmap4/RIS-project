version: '3.8'

services:
  vehicle:
    build:
      context: ../..
      dockerfile: evaluation/docker/Dockerfile.vehicle
    container_name: vehicle_sim
    mem_limit: 3g
    cpus: 0.5
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - ../../evaluation/results:/app/evaluation/results
    networks:
      - vanet

  fog_node:
    build:
      context: ../..
      dockerfile: evaluation/docker/Dockerfile.fog
    container_name: fog_node_sim
    mem_limit: 2g
    cpus: 0.5
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - ../../evaluation/results:/app/evaluation/results
    networks:
      - vanet

  cloud_server:
    build:
      context: ../..
      dockerfile: evaluation/docker/Dockerfile.cloud
    container_name: cloud_server_sim
    mem_limit: 24g
    cpus: 1.0
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - ../../evaluation/results:/app/evaluation/results
    networks:
      - vanet

networks:
  vanet:
    driver: bridge
